---
import Button from "@/components/starwind/button";
import Input from "@/components/starwind/input";
import Label from "@/components/starwind/label";
import Textarea from "@/components/starwind/textarea";
import { getTexts } from "@/utils/i18n";
// import { mail } from "@/utils/const";
const texts = getTexts(Astro);
---

<form
	id="contactForm"
	class="max-w-xl border p-4 rounded-2xl dark:border-gray-200 border-blue-900"
>
	<div class="flex flex-col py-5 text-center">
		<h1 class="text-2xl text-center">{texts.contact.title}</h1>
		<p>{texts.contact.subtitle}</p>
	</div>
	<div class="flex flex-col gap-3">
		<Label for="name">{texts.contact.labels.name}</Label>
		<Input id="name" name="name" placeholder={texts.form.placeholders.name} />
		<Label for="email">{texts.contact.labels.email}</Label>
		<Input id="email" name="email" placeholder={texts.form.placeholders.email} />
		<Label>{texts.contact.labels.message}</Label>
		<Textarea
			name="message"
			placeholder={texts.form.placeholders.message}
			size="lg"
		/>
	</div>
	<div class="w-full flex flex-col py-5">
		<p class="text-center mb-2">{texts.form.send_by}</p>
		<div class="flex gap-5">
			<Button type="submit" class="w-full" variant="success">{texts.social.whatsapp}</Button>
			<!-- <Button type="submit" class="w-full" variant="primary">Email</Button> -->
		</div>
	</div>
</form>

<script>
	import { toast } from "@/components/starwind/toast";
	import { telf } from "@/utils/const";

	const contactForm = document.getElementById("contactForm");
	if (contactForm) {
		contactForm.addEventListener("submit", (e: Event) => {
			e.preventDefault();
			const form = e.target as HTMLFormElement;
			const formData = new FormData(form);
			const data = Object.fromEntries(formData.entries());

			if (!data.name || !data.email || !data.message) {
				toast.error("Por favor, completa todos los campos.");
				return;
			}

			const whatsappMessage = `Hola, tengo una consulta:\n\nNombre: ${data.name}\nEmail: ${data.email}\nMensaje: ${data.message}`;
			const whatsappUrl = `https://wa.me/${telf}?text=${whatsappMessage}`;
			window.open(whatsappUrl, "_blank");
		});
	}
</script>
