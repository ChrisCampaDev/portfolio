---
const myEmail = "christiancampa546@gmail.com";
const myWhatsAppNumber = "5354758835";
import { getTexts } from "@/utils/i18n";
const t = getTexts(Astro);
---

<div class="relative text-white p-8 bg-gray-800 rounded-lg max-w-2xl mx-auto my-10">
    <h2 class="text-2xl font-bold mb-4 text-center">{t.contact.title}</h2>
    <p class="text-center mb-6">{t.contact.subtitle}</p>

    <form id="contact-form" class="space-y-4">
        <div>
            <label for="name" class="block mb-2 text-sm font-medium">{t.contact.labels.name}</label>
            <input type="text" id="name" name="name" class="bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder={t.contact.placeholders.name} required>
        </div>
        <div>
            <label for="email" class="block mb-2 text-sm font-medium">{t.contact.labels.email}</label>
            <input type="email" id="email" name="email" class="bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder={t.contact.placeholders.email} required>
        </div>
        <div>
            <label for="message" class="block mb-2 text-sm font-medium">{t.contact.labels.message}</label>
            <textarea id="message" name="message" rows="4" class="bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder={t.contact.placeholders.message} required></textarea>
        </div>

        <div class="flex flex-col sm:flex-row gap-4 pt-4">
            <button type="submit" id="send-email" class="contact-btn email-btn">
                {t.contact.buttons.sendEmail}
            </button>
            <button type="submit" id="send-whatsapp" class="contact-btn whatsapp-btn">
                {t.contact.buttons.sendWhatsApp}
            </button>
        </div>
    </form>
</div>

<script define:vars={{ myEmail, myWhatsAppNumber, subject: t.contact.subject, alertWhatsAppNotConfigured: t.contact.alertWhatsAppNotConfigured, fName: t.contact.formatted.name, fEmail: t.contact.formatted.email, fMessage: t.contact.formatted.message }}>
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('contact-form');
        const nameInput = document.getElementById('name');
        const emailInput = document.getElementById('email');
        const messageInput = document.getElementById('message');
        const sendEmailBtn = document.getElementById('send-email');
        const sendWhatsappBtn = document.getElementById('send-whatsapp');

        function getFormattedMessage() {
            const name = nameInput.value;
            const email = emailInput.value;
            const message = messageInput.value;

            return `${fName}: ${name}\n${fEmail}: ${email}\n\n${fMessage}:\n${message}`;
        }

        sendEmailBtn.addEventListener('click', (e) => {
            e.preventDefault();
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const subjectText = subject;
            const body = encodeURIComponent(getFormattedMessage());

            window.location.href = `mailto:${myEmail}?subject=${subjectText}&body=${body}`;
        });

        sendWhatsappBtn.addEventListener('click', (e) => {
            e.preventDefault();
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            if (myWhatsAppNumber === 'YOUR_PHONE_NUMBER') {
                alert(alertWhatsAppNotConfigured);
                return;
            }

            const text = encodeURIComponent(getFormattedMessage());
            const whatsappUrl = `https://wa.me/${myWhatsAppNumber}?text=${text}`;

            window.open(whatsappUrl, '_blank');
        });
    });
</script>

<style>
    .contact-btn {
        width: 100%;
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.2s;
        text-align: center;
    }

    .contact-btn:hover {
        transform: translateY(-2px);
    }

    .email-btn {
        background-color: #4A90E2; /* Un color azul */
        color: white;
    }

    .email-btn:hover {
        background-color: #357ABD;
    }

    .whatsapp-btn {
        background-color: #25D366; /* Color de WhatsApp */
        color: white;
    }

    .whatsapp-btn:hover {
        background-color: #1EBE57;
    }
</style>
