---
import { getCollection } from "astro:content";
import Work from "./ui/Work.astro";
import { getTexts, getLocaleFromAstro } from "@/utils/i18n";

const experiences = await getCollection("works");
const t = getTexts(Astro);
const locale = getLocaleFromAstro(Astro);
---
<h4 class="text-white text-center px-5 py-2 text-2xl">{t.experience.title}</h4>
    <div class="mx-auto max-w-3xl p-7">
        <ol class="relative border-l-2 border-blue-500 dark:border-gray-600">
            {experiences.map((work) => {
              const company = locale === 'en' ? (work.data.Company_en ?? work.data.Company) : work.data.Company;
              const description = locale === 'en' ? (work.data.Description_en ?? work.data.Description) : work.data.Description;
              const role = locale === 'en' ? (work.data.Role_en ?? work.data.Role) : work.data.Role;
              const highlights = locale === 'en' ? (work.data.Highlights_en ?? work.data.Highlights) : work.data.Highlights;
              return (
                <Work
                  time={work.data.Date}
                  company={company}
                  description={description}
                  highlights={highlights}
                  role={role}
                  stack={work.data.DevTools}
                />
              );
            })}
        </ol>
    </div>
